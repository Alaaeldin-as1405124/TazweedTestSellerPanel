{"ast":null,"code":"import _toConsumableArray from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Button,Col,Form,ListGroup,Row}from\"react-bootstrap\";import baseService from'../services/baseService';import Table from\"react-bootstrap/Table\";import AddSubCategory from\"./AddSubCategory\";import AddCategory from\"./AddCategory\";import{confirmAlert}from\"react-confirm-alert\";import'react-confirm-alert/src/react-confirm-alert.css';// Import css\nvar Categories=/*#__PURE__*/function(_Component){_inherits(Categories,_Component);function Categories(){var _getPrototypeOf2;var _this;_classCallCheck(this,Categories);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Categories)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={categories:[],loading:true,categoriesModal:false,subCategoriesModal:false,categoryIndex:-1,//for adding subcategory / edit category\nsubCategoryIndex:-1,//for editing the sub category\nedit:false};_this.fetchCategories=function(){baseService.getCategories().then(function(categories){return _this.setState({categories:categories,loading:false});}).catch(function(err){return console.log(err);});};_this.confirmAlert=function(title,func){confirmAlert({title:''+title,message:'Are you sure to do this.',buttons:[{label:'Yes',onClick:function onClick(){if(func)func();}},{label:'No',onClick:function onClick(){_this.alert('hhey no! ');}}]});};_this.alert=function(title){confirmAlert({title:''+title,message:'',buttons:[{label:'Dismiss'}]});};_this.removeCategory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(index){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!window.confirm(\"Are you sure you want to delete this category?\")){_context.next=5;break;}_context.next=3;return baseService.deleteCategory(_this.state.categories[index]);case 3:response=_context.sent;if(response){_this.fetchCategories();}else{_this.alert('Failed to delete category');}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.removeSubCategory=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(categoryIndex,subCategoryIndex){var categories,category,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!window.confirm(\"Are you sure you want to delete this subcategory?\")){_context2.next=7;break;}categories=_toConsumableArray(_this.state.categories);category=categories[categoryIndex];// if (category.subCategories.length === 1) {\n//     alert('Cannot delete, Category Must have at least 1 SubCategory');\n//     return;\n// }\n// category.subCategories.splice(subCategoryIndex, 1);\n// categories[categoryIndex] = category;\n// this.setState({categories})\n_context2.next=5;return baseService.deleteSubCategory(category,category.subCategories[subCategoryIndex]);case 5:response=_context2.sent;if(response){_this.fetchCategories();}else{_this.alert('Failed to delete subcategory');}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2,_x3){return _ref2.apply(this,arguments);};}();_this.addCategory=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(category){var newCategory,categories;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return baseService.addCategory(category);case 2:newCategory=_context3.sent;if(newCategory){console.log(newCategory);//add the category\ncategories=_toConsumableArray(_this.state.categories);categories.push(newCategory);_this.setState({categories:categories,categoriesModal:false});}else{_this.alert('failed to add category');}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4){return _ref3.apply(this,arguments);};}();_this.addSubCategory=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(subCategory){var categories,category,newSubCategory;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0://add sub category\ncategories=_toConsumableArray(_this.state.categories);if(!(_this.state.categoryIndex!==-1)){_context4.next=9;break;}category=categories[_this.state.categoryIndex];_context4.next=5;return baseService.addSubCategory(category,subCategory);case 5:newSubCategory=_context4.sent;if(newSubCategory&&newSubCategory.name){//category.subCategories.push(newSubCategory);\n_this.setState({categoryIndex:-1});_this.fetchCategories();}else{_this.alert('fail to add subCategory');}_context4.next=10;break;case 9:_this.alert('Failed to add sub category');case 10:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x5){return _ref4.apply(this,arguments);};}();_this.editCategory=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(category){var response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return baseService.updateCategory(category);case 2:response=_context5.sent;if(response&&response.name){_this.fetchCategories();//categories[this.state.categoryIndex] = category;\n//this.setState({categories, categoryIndex: -1});\n}else{_this.alert('Failed to update category');}// } else {\n//     alert('Failed to update category');\n//  }\ncase 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x6){return _ref5.apply(this,arguments);};}();_this.editSubCategory=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(subCategory){var categories,category,response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:categories=_toConsumableArray(_this.state.categories);if(!(_this.state.categoryIndex!==-1&&_this.state.subCategoryIndex!==-1)){_context6.next=10;break;}category=categories[_this.state.categoryIndex];_context6.next=5;return baseService.updateSubCategory(category,subCategory);case 5:response=_context6.sent;//category.subCategories[this.state.subCategoryIndex] = subCategory;\nif(response&&response.name){_this.fetchCategories();}else{_this.alert('Failed to update subcategory');}_this.setState({categoryIndex:-1,subCategoryIndex:-1});_context6.next=11;break;case 10:_this.alert('Failed to update sub category');case 11:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x7){return _ref6.apply(this,arguments);};}();return _this;}_createClass(Categories,[{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;console.log('categories will mount');baseService.getCategories().then(function(categories){return _this2.setState({categories:categories,loading:false});}).catch(function(err){return console.log(err);});}},{key:\"render\",value:function render(){var _this3=this;return React.createElement(\"div\",null,React.createElement(\"h2\",null,\"Categories\"),React.createElement(Form,null,React.createElement(Button,{variant:\"success\",onClick:function onClick(){return _this3.setState({categoriesModal:true});}},React.createElement(\"i\",{className:\"fa fa-plus\"}),\" Add Category\"),React.createElement(Table,{striped:true,bordered:true,hover:true},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"#\"),React.createElement(\"th\",null,\"Icon\"),React.createElement(\"th\",null,\"Category Name\"),React.createElement(\"th\",null,\"Category Name (Ar)\"),React.createElement(\"th\",null,\"SubCategories\"),React.createElement(\"th\",null,\"Actions\"))),React.createElement(\"tbody\",null,this.state.categories.length>0?this.state.categories.map(function(category,categoryIndex){return React.createElement(\"tr\",null,React.createElement(\"td\",null,categoryIndex),React.createElement(\"td\",null,React.createElement(\"center\",null,React.createElement(\"img\",{style:{width:64,height:64,padding:5},src:category.icon}))),React.createElement(\"td\",null,category.name),React.createElement(\"td\",null,category.nameAr),React.createElement(\"td\",null,React.createElement(Button,{variant:\"success\",onClick:function onClick(){return _this3.setState({categoryIndex:categoryIndex,subCategoriesModal:true});}},React.createElement(\"i\",{className:\"fa fa-plus\"}),\" Add SubCategory\"),React.createElement(Table,{striped:true,bordered:true,hover:true},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"#\"),React.createElement(\"th\",null,\"Icon\"),React.createElement(\"th\",null,\"Category Name\"),React.createElement(\"th\",null,\"Category Name (Ar)\"),React.createElement(\"th\",null,\"Actions\"))),React.createElement(\"tbody\",null,category.subCategories.length>0?category.subCategories.map(function(subCategory,subCategoryIndex){//do whatever\nreturn React.createElement(\"tr\",null,React.createElement(\"td\",null,subCategoryIndex),React.createElement(\"td\",null,React.createElement(\"center\",null,React.createElement(\"img\",{style:{width:64,height:64,padding:5},src:subCategory.icon}))),React.createElement(\"td\",null,subCategory.name),React.createElement(\"td\",null,subCategory.nameAr),React.createElement(\"td\",{className:\"row\"},React.createElement(\"i\",{className:\"fa fa-trash fa-2x\",style:{color:'red'},onClick:function onClick(){return _this3.removeSubCategory(categoryIndex,subCategoryIndex);}}),React.createElement(\"i\",{className:\"fa fa-edit fa-2x\",style:{color:'green'},onClick:function onClick(){return _this3.setState({categoryIndex:categoryIndex,subCategoryIndex:subCategoryIndex,edit:true,subCategoriesModal:true});}})));}):React.createElement(\"tr\",null,React.createElement(\"td\",{colSpan:\"5\"},React.createElement(\"center\",null,\"No subcategories yet\")))))),React.createElement(\"td\",{className:\"row\"},React.createElement(\"i\",{className:\"fa fa-trash fa-2x\",style:{color:'red'},onClick:function onClick(){return _this3.removeCategory(categoryIndex);}}),React.createElement(\"i\",{className:\"fa fa-edit fa-2x\",style:{color:'green'},onClick:function onClick(){return _this3.setState({categoryIndex:categoryIndex,edit:true,categoriesModal:true});}})));}):React.createElement(\"tr\",null,React.createElement(\"td\",{colSpan:\"6\"},React.createElement(\"center\",null,\"No categories yet\")))))),React.createElement(AddCategory,{modal:this.state.categoriesModal,handleClose:function handleClose(){return _this3.setState({categoriesModal:false,categoryIndex:-1,edit:false});},addCategory:this.addCategory,edit:this.state.edit,editCategory:this.editCategory,category:this.state.categories[this.state.categoryIndex]}),React.createElement(AddSubCategory,{modal:this.state.subCategoriesModal,handleClose:function handleClose(){return _this3.setState({subCategoriesModal:false,categoryIndex:-1,edit:false});},addSubCategory:this.addSubCategory,edit:this.state.edit,editSubCategory:this.editSubCategory,category:this.state.categories[this.state.categoryIndex],subCategoryIndex:this.state.subCategoryIndex}));}}]);return Categories;}(Component);export default Categories;","map":{"version":3,"sources":["/Users/alaaeldin/Documents/GitHub/gateofegyptadmin/src/components/Categories.js"],"names":["React","Component","Button","Col","Form","ListGroup","Row","baseService","Table","AddSubCategory","AddCategory","confirmAlert","Categories","state","categories","loading","categoriesModal","subCategoriesModal","categoryIndex","subCategoryIndex","edit","fetchCategories","getCategories","then","setState","catch","err","console","log","title","func","message","buttons","label","onClick","alert","removeCategory","index","window","confirm","deleteCategory","response","removeSubCategory","category","deleteSubCategory","subCategories","addCategory","newCategory","push","addSubCategory","subCategory","newSubCategory","name","editCategory","updateCategory","editSubCategory","updateSubCategory","length","map","width","height","padding","icon","nameAr","color"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {Button, Col, Form, ListGroup, Row} from \"react-bootstrap\";\nimport baseService from '../services/baseService'\nimport Table from \"react-bootstrap/Table\";\nimport AddSubCategory from \"./AddSubCategory\";\nimport AddCategory from \"./AddCategory\";\nimport {confirmAlert} from \"react-confirm-alert\";\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\n\nclass Categories extends Component {\n    state = {\n        categories: [],\n        loading: true,\n        categoriesModal: false,\n        subCategoriesModal: false,\n        categoryIndex: -1, //for adding subcategory / edit category\n        subCategoryIndex: -1, //for editing the sub category\n        edit: false,\n\n    };\n\n    componentWillMount() {\n        console.log('categories will mount')\n        baseService.getCategories().then((categories) => this.setState({\n            categories,\n            loading: false\n        })).catch((err) => console.log(err));\n    }\n\n    fetchCategories = () => {\n        baseService.getCategories().then((categories) => this.setState({\n            categories,\n            loading: false\n        })).catch((err) => console.log(err));\n    }\n    confirmAlert = (title, func) => {\n        confirmAlert({\n            title: '' + title,\n            message: 'Are you sure to do this.',\n            buttons: [\n                {\n                    label: 'Yes',\n                    onClick: () => {\n                        if (func)\n                            func()\n                    }\n                },\n                {\n                    label: 'No',\n                    onClick: () => {\n                        this.alert('hhey no! ')\n                    }\n                }\n            ]\n        });\n    };\n\n    alert = (title) => {\n        confirmAlert({\n            title: '' + title,\n            message: '',\n            buttons: [{label: 'Dismiss'}]\n        });\n    };\n    removeCategory = async (index) => {\n        /*\n        let categories = [...this.state.categories];\n        categories.splice(index, 1);\n        this.setState({categories});*/\n\n        if (window.confirm(\"Are you sure you want to delete this category?\")) {\n            let response = await baseService.deleteCategory(this.state.categories[index]);\n            if (response) {\n                this.fetchCategories()\n            } else {\n                this.alert('Failed to delete category')\n            }\n        }\n\n\n\n\n\n    };\n    removeSubCategory = async (categoryIndex, subCategoryIndex) => {\n\n\n        if (window.confirm(\"Are you sure you want to delete this subcategory?\")) {\n            let categories = [...this.state.categories];\n            let category = categories[categoryIndex];\n            // if (category.subCategories.length === 1) {\n            //     alert('Cannot delete, Category Must have at least 1 SubCategory');\n            //     return;\n            // }\n            // category.subCategories.splice(subCategoryIndex, 1);\n            // categories[categoryIndex] = category;\n            // this.setState({categories})\n            let response = await baseService.deleteSubCategory(category, category.subCategories[subCategoryIndex])\n            if (response) {\n                this.fetchCategories();\n            } else {\n                this.alert('Failed to delete subcategory')\n            }\n        }\n\n\n    };\n    addCategory = async (category) => {\n        //add category\n        let newCategory = await baseService.addCategory(category);\n        if (newCategory) {\n            console.log(newCategory);\n            //add the category\n\n            let categories = [...this.state.categories];\n            categories.push(newCategory);\n            this.setState({categories, categoriesModal: false});\n        } else {\n            this.alert('failed to add category')\n        }\n\n    };\n    addSubCategory = async (subCategory) => {\n        //add sub category\n        let categories = [...this.state.categories];\n        if (this.state.categoryIndex !== -1) {\n            let category = categories[this.state.categoryIndex];\n            let newSubCategory = await baseService.addSubCategory(category, subCategory);\n            if (newSubCategory && newSubCategory.name) {\n                //category.subCategories.push(newSubCategory);\n                this.setState({categoryIndex: -1});\n                this.fetchCategories();\n            } else {\n                this.alert('fail to add subCategory')\n            }\n        } else {\n            this.alert('Failed to add sub category');\n        }\n\n    };\n\n\n    editCategory = async (category) => {\n        //let categories = [...this.state.categories];\n        // if (this.state.categoryIndex !== -1) {\n        let response = await baseService.updateCategory(category);\n        if (response && response.name) {\n            this.fetchCategories();\n            //categories[this.state.categoryIndex] = category;\n            //this.setState({categories, categoryIndex: -1});\n        } else {\n            this.alert('Failed to update category');\n        }\n        // } else {\n        //     alert('Failed to update category');\n        //  }\n    };\n\n    editSubCategory = async (subCategory) => {\n        let categories = [...this.state.categories];\n\n        if (this.state.categoryIndex !== -1 && this.state.subCategoryIndex !== -1) {\n            let category = categories[this.state.categoryIndex];\n            let response = await baseService.updateSubCategory(category, subCategory);\n            //category.subCategories[this.state.subCategoryIndex] = subCategory;\n            if (response && response.name) {\n                this.fetchCategories();\n            } else {\n                this.alert('Failed to update subcategory')\n            }\n            this.setState({categoryIndex: -1, subCategoryIndex: -1});\n        } else {\n            this.alert('Failed to update sub category');\n        }\n    };\n\n    render() {\n        return (\n            <div>\n                <h2>Categories</h2>\n\n\n                <Form>\n                    <Button variant=\"success\" onClick={() => this.setState({categoriesModal: true})}>\n                        <i className=\"fa fa-plus\"/> Add Category\n                    </Button>\n\n                    <Table striped bordered hover>\n                        <thead>\n                        <tr>\n                            <th>#</th>\n                            <th>Icon</th>\n                            <th>Category Name</th>\n                            <th>Category Name (Ar)</th>\n                            <th>SubCategories</th>\n                            <th>Actions</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n\n                        {this.state.categories.length > 0 ? this.state.categories.map((category, categoryIndex) => {\n                            return (\n                                <tr>\n                                    <td>{categoryIndex}</td>\n                                    <td>\n                                        <center>\n                                            <img style={{width: 64, height: 64, padding: 5}} src={category.icon}/>\n                                        </center>\n                                    </td>\n                                    <td>{category.name}</td>\n                                    <td>{category.nameAr}</td>\n                                    <td>\n                                        <Button variant=\"success\" onClick={() => this.setState({\n                                            categoryIndex: categoryIndex,\n                                            subCategoriesModal: true\n                                        })}>\n                                            <i className=\"fa fa-plus\"/> Add SubCategory\n                                        </Button>\n\n                                        <Table striped bordered hover>\n                                            <thead>\n                                            <tr>\n                                                <th>#</th>\n                                                <th>Icon</th>\n                                                <th>Category Name</th>\n                                                <th>Category Name (Ar)</th>\n                                                <th>Actions</th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                            {category.subCategories.length > 0 ? category.subCategories.map((subCategory, subCategoryIndex) => {\n                                                //do whatever\n                                                return (\n                                                    <tr>\n                                                        <td>{subCategoryIndex}</td>\n                                                        <td>\n                                                            <center>\n                                                                <img style={{width: 64, height: 64, padding: 5}}\n                                                                     src={subCategory.icon}/>\n                                                            </center>\n                                                        </td>\n                                                        <td>{subCategory.name}</td>\n                                                        <td>{subCategory.nameAr}</td>\n                                                        <td className=\"row\">\n                                                            <i className=\"fa fa-trash fa-2x\" style={{color: 'red'}}\n                                                               onClick={() => this.removeSubCategory(categoryIndex, subCategoryIndex)}/>\n                                                            <i className=\"fa fa-edit fa-2x\" style={{color: 'green'}}\n                                                               onClick={() => this.setState({\n                                                                   categoryIndex: categoryIndex,\n                                                                   subCategoryIndex: subCategoryIndex,\n                                                                   edit: true,\n                                                                   subCategoriesModal: true\n                                                               })}/>\n                                                        </td>\n                                                    </tr>\n                                                )\n                                            }) : <tr>\n                                                <td colSpan=\"5\">\n                                                    <center>No subcategories yet</center>\n                                                </td>\n                                            </tr>}\n\n                                            </tbody>\n                                        </Table>\n                                    </td>\n                                    <td className=\"row\">\n                                        <i className=\"fa fa-trash fa-2x\" style={{color: 'red'}}\n                                           onClick={() => this.removeCategory(categoryIndex)}/>\n                                        <i className=\"fa fa-edit fa-2x\" style={{color: 'green'}}\n                                           onClick={() => this.setState({\n                                               categoryIndex: categoryIndex,\n                                               edit: true,\n                                               categoriesModal: true\n                                           })}/>\n                                    </td>\n                                </tr>\n                            )\n                        }) : <tr>\n                            <td colSpan=\"6\">\n                                <center>No categories yet</center>\n                            </td>\n                        </tr>}\n\n                        </tbody>\n                    </Table>\n                </Form>\n\n                <AddCategory modal={this.state.categoriesModal}\n                             handleClose={() => this.setState({categoriesModal: false, categoryIndex: -1, edit: false})}\n                             addCategory={this.addCategory}\n                             edit={this.state.edit}\n                             editCategory={this.editCategory}\n                             category={this.state.categories[this.state.categoryIndex]}\n                />\n                <AddSubCategory modal={this.state.subCategoriesModal}\n                                handleClose={() => this.setState({\n                                    subCategoriesModal: false,\n                                    categoryIndex: -1,\n                                    edit: false\n                                })}\n                                addSubCategory={this.addSubCategory}\n                                edit={this.state.edit}\n                                editSubCategory={this.editSubCategory}\n                                category={this.state.categories[this.state.categoryIndex]}\n                                subCategoryIndex={this.state.subCategoryIndex}\n                />\n            </div>\n        );\n    }\n}\n\nexport default Categories;\n"]},"metadata":{},"sourceType":"module"}